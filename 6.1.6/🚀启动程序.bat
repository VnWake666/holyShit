@echo off
setlocal enabledelayedexpansion

REM ==================== ç¼–ç å’ŒçŽ¯å¢ƒè®¾ç½® ====================
REM è®¾ç½®UTF-8ç¼–ç æ”¯æŒä¸­æ–‡å’ŒEmoji
chcp 65001 >nul 2>&1
title ðŸš€ å¸å®‰èµ„é‡‘è´¹çŽ‡æ³¢åŠ¨TOP5ç›‘æŽ§å·¥å…· v3.0

REM ==================== æ¬¢è¿Žç•Œé¢ ====================
cls
echo.
echo ================================================================
echo                   ðŸš€ å¸å®‰èµ„é‡‘è´¹çŽ‡æ³¢åŠ¨TOP5ç›‘æŽ§å·¥å…·
echo ================================================================
echo                        æ™ºèƒ½å¯åŠ¨ç³»ç»Ÿ v3.0
echo ================================================================
echo.

REM ==================== PythonçŽ¯å¢ƒæ£€æµ‹ ====================
echo ðŸ“‹ æ£€æŸ¥Pythonè¿è¡ŒçŽ¯å¢ƒ...
echo.

python --version >nul 2>&1
if !errorlevel! equ 0 (
    for /f "tokens=2" %%v in ('python --version 2^>^&1') do (
        echo [æˆåŠŸ] âœ… PythonçŽ¯å¢ƒæ­£å¸¸ ^(ç‰ˆæœ¬: %%v^)
    )
    echo.
    echo ðŸš€ å¯åŠ¨å¸å®‰èµ„é‡‘è´¹çŽ‡ç›‘æŽ§å·¥å…·...
    echo.
    echo ðŸ’¡ å¯åŠ¨è¯´æ˜Ž:
    echo    â€¢ ç¨‹åºå°†è‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¾èµ–åŒ…
    echo    â€¢ ç¨‹åºå°†è‡ªåŠ¨å¤„ç†ç«¯å£å†²çªé—®é¢˜
    echo    â€¢ ç¨‹åºå¯åŠ¨åŽå°†è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ç•Œé¢
    echo    â€¢ æŒ‰ Ctrl+C å¯å®‰å…¨é€€å‡ºç¨‹åº
    echo    â€¢ ä¿æŒæ­¤çª—å£æ‰“å¼€ä»¥ç»´æŒç¨‹åºè¿è¡Œ
    echo.
    echo â³ æ­£åœ¨å¯åŠ¨ï¼Œè¯·ç¨å€™...
    echo ================================================================
    echo.
    
    REM å¯åŠ¨ä¸»ç¨‹åº - è®©main.pyå¤„ç†æ‰€æœ‰å¤æ‚é€»è¾‘
    python main.py
    set "EXIT_CODE=!errorlevel!"
    
    REM å¤„ç†ç¨‹åºé€€å‡ºçŠ¶æ€
    echo.
    echo ================================================================
    if !EXIT_CODE! equ 0 (
        echo                    âœ… ç¨‹åºæ­£å¸¸é€€å‡º
        echo ================================================================
        echo.
        echo ðŸŽ‰ æ„Ÿè°¢ä½¿ç”¨å¸å®‰èµ„é‡‘è´¹çŽ‡ç›‘æŽ§å·¥å…·ï¼
        echo ðŸ’ å¦‚æžœè§‰å¾—å¥½ç”¨ï¼Œè¯·æŽ¨èç»™æœ‹å‹ä»¬~
        echo.
    ) else (
        echo                    âŒ ç¨‹åºå¼‚å¸¸é€€å‡º
        echo ================================================================
        echo.
        echo ðŸ” å¯èƒ½çš„åŽŸå› :
        echo    â€¢ ç½‘ç»œè¿žæŽ¥ä¸­æ–­ - æ— æ³•è¿žæŽ¥å¸å®‰API
        echo    â€¢ ç³»ç»Ÿèµ„æºä¸è¶³ - å†…å­˜æˆ–CPUå ç”¨è¿‡é«˜
        echo    â€¢ ç¨‹åºæ–‡ä»¶æŸå - æ ¸å¿ƒæ¨¡å—æ–‡ä»¶ç¼ºå¤±æˆ–æŸå
        echo    â€¢ é˜²ç«å¢™é˜»æ­¢ - ç½‘ç»œè®¿é—®è¢«é™åˆ¶
        echo.
        echo ðŸ› ï¸  å»ºè®®è§£å†³æ–¹æ¡ˆ:
        echo    1. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥æ˜¯å¦æ­£å¸¸
        echo    2. é‡å¯ç”µè„‘åŽé‡æ–°è¿è¡Œç¨‹åº
        echo    3. ä¸´æ—¶å…³é—­é˜²ç«å¢™æˆ–æ€æ¯’è½¯ä»¶
        echo    4. é‡æ–°ä¸‹è½½ç¨‹åºæ–‡ä»¶
        echo.
    )
) else (
    echo [é”™è¯¯] âŒ æœªæ£€æµ‹åˆ°PythonçŽ¯å¢ƒ
    echo.
    goto :python_install_guide
)

echo ================================================================
echo.
echo æŒ‰ä»»æ„é”®å…³é—­çª—å£...
pause >nul
exit /b !EXIT_CODE!

REM ==================== Pythonå®‰è£…æŒ‡å— ====================
:python_install_guide
echo ================================================================
echo                    ðŸ Pythonå®‰è£…æŒ‡å—
echo ================================================================
echo.
echo ðŸ“¥ è¯·æŒ‰ä»¥ä¸‹æ­¥éª¤å®‰è£…Python:
echo.
echo 1. ðŸŒ è®¿é—®Pythonå®˜æ–¹ç½‘ç«™:
echo    https://www.python.org/downloads/
echo.
echo 2. ðŸ“¦ ä¸‹è½½Python 3.8æˆ–æ›´é«˜ç‰ˆæœ¬
echo    æŽ¨èä¸‹è½½æœ€æ–°ç¨³å®šç‰ˆæœ¬
echo.
echo 3. âš™ï¸  å®‰è£…æ—¶çš„é‡è¦è®¾ç½®:
echo    âœ… åŠ¡å¿…å‹¾é€‰ "Add Python to PATH"
echo    âœ… é€‰æ‹© "Install for all users" (å¯é€‰)
echo    âœ… é€‰æ‹© "Add Python to environment variables"
echo.
echo 4. ðŸ”„ å®‰è£…å®ŒæˆåŽ:
echo    â€¢ é‡å¯å‘½ä»¤æç¤ºç¬¦æˆ–é‡å¯ç”µè„‘
echo    â€¢ é‡æ–°è¿è¡Œæ­¤å¯åŠ¨è„šæœ¬
echo.
echo ðŸ’¡ éªŒè¯å®‰è£…: åœ¨å‘½ä»¤è¡Œè¾“å…¥ python --version
echo    å¦‚æžœæ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œè¯´æ˜Žå®‰è£…æˆåŠŸ
echo.
echo ================================================================
echo.
echo æŒ‰ä»»æ„é”®å…³é—­çª—å£...
pause >nul
exit /b 1
